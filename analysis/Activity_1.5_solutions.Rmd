### Activity 1.5 Solutions ###

Solutions to the exercises in Activity 1.5.

#### Exercise 1.5.1: A simple linear regression model 

1) Look at the Old Faithful geyser data in Yellowstone
   National Park.  It's the `faithful` dataset available in
    the base R distribution.  Use `help(faithful)` or `?faithful`
    to see its documentation

2) Plot the waiting time to the next eruptions vs. the
    duration of the eruption

3) Fit a simple linear regression model to predict waiting
    time from the eruption duration

4) Overlay the fitted model on the plot with a red line

##### Solution 

Look at the documentation:

```{r}
?faithful
```

Plot the data:

```{r}
with(faithful, plot(eruptions, waiting))
```

Fit the simple linear regression model:

```{r}
slrModel <- lm(waiting ~ eruptions, data = faithful)
```

Overlay a regression line, make it thick with the `lwd`
(line width) argument:

```{r}
slrModel <- lm(waiting ~ eruptions, data = faithful)
plot(faithful[,'eruptions'], faithful[,'waiting'])
abline(slrModel, col = "Red", lwd = 5)
```

Shut down the graph:

```{r}
dev.off()
```

#### Exercise 1.5.2: Factors 

1) Create a numeric vector with arbitrarily repeated
    values of 1.2, 3, and 7.9 .

2) Create the numeric vector to a factor, where 3 will be
    numerically encoded as a 1, 7.9 as a 2, and 1.2 as 3.
    Display the numerical encoding

3) Display the levels of the factor

4) Convert the factor back to the original numerical vector

5) Create a subset of the factor when it equals 1.2 or 3

##### Solution 

Create a numeric vector:

```{r}
x <- c(rep(1.2, 3), rep(3, 2), rep(7.9, 4))
```

Convert it to a factor with the encoding specified:

```{r}
xf <- factor(x, levels = c(3, 7.9, 1.2))
xf
```

Display the numerical encoding:

```{r}
as.numeric(xf)
```

Display the levels:

```{r}
levels(xf)
```

Convert the factor object back to numeric again and compare:

```{r}
xCompare <- as.numeric(levels(xf)[xf])
identical(xCompare, x)
```

Create a subset when the factor is 1.2 or 3.  Both of these
produce identical results. In the second instance,
R converts the numeric values of 1.2 and 3 to character.

```{r}
xf[xf %in% c("1.2", "3")]
xf[xf %in% c(1.2, 3)]
```


#### Exercise 1.5.3: Trellis plots

1) Attach the quakes data that comes with R. Look at the
    columns using `head()` or `str()`

2) Use `xyplot` to plot lat vs. long for the location of the
    earthquakes. Label the axes and the main graphs
    using the following command to bin the depth variable into
    9 bins:

    `depthbin <- equal.count(quakes$depth, number = 9,
                            overlap = 0)`

    Make sure you have loaded the lattice package via:
    `library(lattice)`

3) Now use `xyplot()` to plot lat,long for each depth bin of
    the earthquake to create a set of graphs in a trellis
    display.
    
    
##### Solution

Attach quakes for convenience in accessing its columns:

```{r}
attach(quakes)
```

Check out the data

```{r}
head(quakes)
str(quakes)
```

Create the depth binning variable:

```{r}
library(lattice)
depth_bin <- equal.count(quakes$depth, number = 9, overlap = 0)
```

Produce the plot:

```{r}
xyplot(lat ~long | depth_bin,
       main = "Earthquakes in the Pacific",
       xlab = "longitude", ylab = "latitude")
```

Detach the quakes data frame:

```{r}
detach(quakes)
```

